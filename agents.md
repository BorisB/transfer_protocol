# Агент (инструкции по взаимодействию)

Этот документ описывает, как эффективно работать с агентом (помощником) при создании романа "ПРОТОКОЛ ПЕРЕДАЧИ". Он содержит рекомендации по формулировке задач, шаблоны prompt'ов, правила оформления файлов и рабочие соглашения для совместной работы.

## Коротко — роль агента
- Помогает писать тексты, править и структурировать материал, генерировать идеи, создавать сцены и диалоги.
- Делает повторяющуюся работу (рефакторинг текста, разбивка на главы, создание чек-листов).
- Проверяет согласованность мира, логики и «оружия Чехова» по индексам.

## Как ставить задачу (простое правило)
1. Название задачи — одна строка, однозначно говорящая, чего вы хотите.
2. Краткое описание (1-3 предложения) — цель и контекст.
3. Входные данные — файлы/места в репозитории, к которым нужно обратиться (пути).
4. Желаемый формат вывода — файл, список, черновик главы, таблица.
5. Ограничения (объём, тон, персонажи, временные рамки).

Пример короткой задачи:

Задача: "Напиши черновик сцены — Лаборатория, стадия 3 (Принятие)"
Описание: "Сцена должна быть 800–1200 слов, фокус на внутреннем конфликте Доктора и проблеске в архитектуре памяти. Использовать атмосферу из `02-worldbuilding/location-01-laboratory.md`."
Вход: `02-worldbuilding/location-01-laboratory.md`, `04-outline/locations-story-circle-map.md`
Вывод: `04-outline/scene-drafts/scene-lab-03.md` (черновик)

## Полезные шаблоны prompt'ов

- Рефайнер текста (редактура и стиль):

  "Отредактируй файл `path/to/file.md` так, чтобы он совпадал с тоном `04-outline/ai-narrator-voice.md`, сократи повторения, улучши плавность, пометь места для возможного сокращения сцен. Версия: черновик -> отредактировка."

- Создать сцену по Story Circle:

  "Сгенерируй сцену 900 слов для Локации X на стадии Y из `04-outline/locations-story-circle-map.md`. Удерживай голос рассказчика: осторожный, эмпатичный, аналитический. Подключи 2-3 соответствующих items из `04-outline/chekhov-guns-master-index.md`."

- Проверка согласованности:

  "Проверь `02-worldbuilding/*.md` на наличие противоречий: даты, имена, технологии — выведи таблицу несоответствий и предложи правки."

## Формат и метаданные файлов
- Все новые главы и сцены хранить в `04-outline/scene-drafts/` с префиксом `scene-XX-`.
- Использовать YAML-фронтматтер в начале MD-файлов для ключевых метаданных:

  ```yaml
  ---
  title: "Название сцены"
  location: "location-01-laboratory"
  stage: 3
  wordcount: 900
  draft: true
  ---
  ```

- В описаниях изменений в коммитах писать: `type(scope): краткое описание` — пример: `feat(scene): add lab scene stage-3 draft`.

## Ветки и рабочий процесс
- Главная ветка `main` — всегда в рабочем состоянии; только готовые черновики и метаданные туда попадают.
- Для крупных задач создаём ветки `feature/<short-name>` (например `feature/scene-lab-03`).
- Мелкие правки можно вносить напрямую в `main` через коммиты, если это не ломает целостность (например, опечатки, метаданные).

## Чек-лист для каждой новой сцены (copy/paste)
1. Создать файл `04-outline/scene-drafts/scene-<location>-<stage>.md` с YAML-фронтматтером.
2. Указать связанные items из `04-outline/chekhov-guns-master-index.md`.
3. Пронумеровать и пометить чек-пойнты: пересмотры, заметки редактора, тест на связность.
4. Попросить агента выполнить первую редактуру (редактура по голосу и длине).
5. Добавить в `PROJECT-PLAN.md` запись о прогрессе (дата, кто делал, статус).

## Как давать обратную связь агенту
- Давайте конкретные примеры того, что не понравилось: "слишком академично", "не хватает эмоций", "сделать сцену короче на 20%".
- Просите итерации: "Сделай 3 варианта — A (експозиция), B (диалог-фокус), C (минималистичный)."

## Автоматические проверки, которые можно просить
- Сверка упоминаний (имена/даты/технологии) между файлов — вывод в виде CSV.
- Подсчёт сцен и распределение по Story Circle — дай таблицу.
- Генерация списка вопросов для глубокой проработки персонажей по каждой сцене.

## Примеры рабочих запросов (copy/paste)

1) Создать черновик сцены:

"Создать сцену: Location=location-02-square, Stage=5, Wordcount=1000. Использовать тон `04-outline/ai-narrator-voice.md`. Связанныеguns: 12, 45. Вывести как `04-outline/scene-drafts/scene-square-05.md`."

2) Редактировать существующий файл:

"Отредактируй `04-outline/scene-drafts/scene-lab-03.md`: сократи на 25%, усили эмоции доктора, исправь повторяющиеся образы. Сохрани как `.../scene-lab-03.v2.md`."

3) Проверка согласованности:

"Проверь на согласованность: `02-worldbuilding/*.md` и `04-outline/chekhov-guns-master-index.md`. Верни CSV с полями: source_file, key, value, conflict_with, suggested_fix."

## Политика правок и версии
- Каждую значимую правку фиксируем новым файлом с `.v2`, `.v3` или через git-ветку и PR.
- Мелкие правки — коммиты в той же версии с явным сообщением (см. правила коммитов).

## Пример: быстрый рабочий сценарий (step-by-step)
1. Написать задачу в одном предложении и вставить ссылки на файлы.
2. Попросить агента сгенерировать первый черновик сцены (900–1100 слов).
3. Получить черновик, проверить на соответствие голосу, дать точные правки.
4. Попросить агента выполнить редактуру.
5. Перенести в `main` через PR после проверки человеком.

## Что агент не делает автоматически
- Не публикует в удалённые репозитории без вашего разрешения (агент создаёт файлы и предлагает коммиты; вы их подтверждаете).
- Не принимает окончательные сюжетные решения без явного запроса.

## Контакты и метаданные
- Автор: команда проекта "ПРОТОКОЛ ПЕРЕДАЧИ".
- Формат: Markdown, UTF-8.
- Дата создания: 2025-11-09

---

Если хотите, могу сразу создать ветку `feature/agents-docs` и запушить этот файл, а также открыть PR с описанием. Напишите, делать ли это автоматически.
